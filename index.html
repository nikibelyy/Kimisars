<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Пробки Воронеж</title>
    <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
    <!-- Подключение Яндекс.Карт с твоим API-ключом -->
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&apikey=3de168ba-04ed-42f5-bb4e-6abff9b3f317" type="text/javascript"></script>
    <script type="text/javascript">
        ymaps.ready(init);

        function init() {
            // Создаем карту с резервным центром и тёмной темой
            var myMap = new ymaps.Map("map", {
                center: [51.6608, 39.2003], // Воронеж
                zoom: 11,
                controls: [],
                type: "yandex#darkMap"
            });

            // Добавляем слой пробок с дорожными событиями
            var trafficLayer = new ymaps.traffic.layer.Actual({
                infoLayerShown: true // включает дорожные события (ДТП, ремонт и т.д.)
            });
            myMap.layers.add(trafficLayer);

            // Геокодируем Воронеж для расширенного охвата
            ymaps.geocode("Воронеж", { results: 1 }).then(function(res) {
                var city = res.geoObjects.get(0);
                if (city) {
                    var bounds = city.properties.get('boundedBy');

                    // Расширяем границы на 30% для окрестностей и трасс
                    var latDiff = (bounds[1][0] - bounds[0][0]) * 0.3;
                    var lonDiff = (bounds[1][1] - bounds[0][1]) * 0.3;
                    var extendedBounds = [
                        [bounds[0][0] - latDiff, bounds[0][1] - lonDiff],
                        [bounds[1][0] + latDiff, bounds[1][1] + lonDiff]
                    ];

                    myMap.setBounds(extendedBounds, { checkZoomRange: true, zoomMargin: 20 });
                }
            });

            // Автообновление пробок каждые 2 минуты
            setInterval(function() {
                trafficLayer.reload();
            }, 120000);
        }
    </script>
</head>
<body>
    <div id="map"></div>
</body>
</html>
